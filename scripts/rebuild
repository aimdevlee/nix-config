#!/usr/bin/env bash

# Auto-detect profile based on current user if TARGET not set
if [ -z "$TARGET" ]; then
    case "$(whoami)" in
        "aimdevlee")
            TARGET="personal"
            ;;
        "dongbin-lee")
            TARGET="work"
            ;;
        *)
            # Default to personal for unknown users
            TARGET="personal"
            echo "‚ö†Ô∏è  Unknown user '$(whoami)', defaulting to personal profile"
            ;;
    esac
fi

echo "üî® Rebuilding configuration for profile: $TARGET"
echo "   User: $(whoami)"
echo "   (Override with TARGET=work or TARGET=personal if needed)"
echo ""

sudo darwin-rebuild switch --flake ".#$TARGET"